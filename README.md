# QuLab: Interactive Unsupervised Clustering Lab

![QuLab Logo](https://www.quantuniversity.com/assets/img/logo5.jpg)

## Project Title and Description

**QuLab** is an interactive Streamlit application designed as a laboratory environment for exploring and understanding various unsupervised clustering techniques. Unsupervised learning is a powerful paradigm in machine learning that aims to discover hidden patterns or intrinsic structures in unlabeled data. In financial markets, this can be invaluable for tasks such as market segmentation, identifying correlated assets, or constructing diversified portfolios.

This application provides a hands-on experience with three fundamental clustering algorithms:

1.  **k-Means Clustering**: A partition-based algorithm that aims to partition observations into distinct clusters based on their proximity to cluster centroids.
2.  **Spectral Clustering**: A technique that leverages the graph structure of data through eigenvalue decomposition to find non-globular or intertwined clusters.
3.  **Agglomerative Hierarchical Clustering**: A "bottom-up" approach that builds a hierarchy of clusters by progressively merging similar data points or clusters, visualized through a dendrogram.

Through interactive demonstrations and parameter tuning, users can gain practical experience, understand the underlying principles, and interpret the results of these algorithms, particularly in a simulated financial context.

### Learning Goals

Upon completion of this application, users will be able to:

*   Understand the operational principles of k-Means, Spectral, and Agglomerative Hierarchical clustering algorithms.
*   Analyze the impact of different parameters (e.g., number of clusters $k$, linkage methods, affinity kernels) on clustering results.
*   Visualize cluster assignments in 2D space and interpret dendrograms generated by hierarchical clustering.
*   Gain insights into how clustering can be applied for tasks such as financial market segmentation or portfolio construction, with specific demonstrations using synthetic financial data.

## Features

*   **Interactive Clustering Algorithms**: Explore k-Means, Spectral, and Agglomerative Hierarchical Clustering.
*   **Parameter Tuning**: Dynamically adjust key algorithm parameters such as:
    *   **Number of Clusters ($k$)**: For all algorithms.
    *   **Linkage Method**: For Agglomerative Hierarchical Clustering (Ward, Complete, Average, Single).
    *   **Distance Metric**: For Agglomerative Hierarchical Clustering (Euclidean, Manhattan, Cosine, etc.).
    *   **Affinity Kernel**: For Spectral Clustering (RBF, Nearest Neighbors).
*   **Data Source Selection**: Choose between two pre-defined synthetic financial datasets or upload your own CSV data.
*   **Real-time Visualization**:
    *   Interactive 2D scatter plots of cluster assignments using Plotly Express.
    *   Dendrogram visualization for Hierarchical Clustering using Matplotlib, showing cluster merging and cut-off points.
*   **Clustering Quality Metrics**: Evaluate clustering performance using the Silhouette Score for all algorithms.
*   **Clear Explanations**: Theoretical background and mathematical formulations for each algorithm are provided directly within the application.
*   **Data Preprocessing**: Automatic `StandardScaler` application to ensure features are standardized, crucial for distance-based algorithms.
*   **Modular Design**: Application pages are structured for clear navigation and focused exploration of each clustering technique.

## Getting Started

Follow these instructions to get a copy of the project up and running on your local machine.

### Prerequisites

Ensure you have Python installed (Python 3.8+ is recommended).

*   [Python](https://www.python.org/downloads/)

### Installation

1.  **Clone the repository**:

    ```bash
    git clone https://github.com/your-username/QuLab.git
    cd QuLab
    ```

    *(Note: Replace `your-username` with the actual repository owner's username if cloning from a public source, or adapt if you're working with a local project structure.)*

2.  **Create a virtual environment (recommended)**:

    ```bash
    python -m venv venv
    source venv/bin/activate  # On Windows use `venv\Scripts\activate`
    ```

3.  **Install the required packages**:

    Create a `requirements.txt` file in your `QuLab` directory with the following content:

    ```
    streamlit>=1.0
    numpy
    pandas
    plotly-express
    matplotlib
    scikit-learn>=1.0
    scipy
    ```

    Then install them:

    ```bash
    pip install -r requirements.txt
    ```

## Usage

1.  **Run the Streamlit application**:

    From the root directory of your project (`QuLab/`), execute the following command in your terminal:

    ```bash
    streamlit run app.py
    ```

2.  **Access the Application**:
    The application will automatically open in your default web browser (usually at `http://localhost:8501`).

3.  **Navigate and Interact**:
    *   Use the **"Data Source Selection"** in the sidebar to choose between synthetic demo datasets (K-Means Portfolio Data, Spectral Assets Data) or to **Upload Your Own Data** (CSV format).
    *   Use the **"Navigation"** selectbox in the sidebar to switch between the three clustering algorithms: "K-Means Clustering", "Spectral Clustering", and "Agglomerative Hierarchical Clustering".
    *   On each page, interact with the sliders, select boxes, and other widgets to tune algorithm parameters (e.g., number of clusters, linkage method, affinity kernel).
    *   Observe the real-time updates to the scatter plots, dendrograms, and Silhouette Score metric.

## Project Structure

The project follows a modular structure to organize the Streamlit application code and assets.

```
QuLab/
├── app.py                         # Main Streamlit application file and data utilities
├── requirements.txt               # List of Python dependencies
├── application_pages/             # Directory containing individual clustering pages
│   ├── __init__.py                # Makes 'application_pages' a Python package
│   ├── page1.py                   # K-Means Clustering page logic
│   ├── page2.py                   # Spectral Clustering page logic
│   └── page3.py                   # Agglomerative Hierarchical Clustering page logic
└── README.md                      # Project README file
```

*   **`app.py`**: This is the entry point of the Streamlit application. It sets up the page configuration, displays the main introduction, initializes session state variables for data, handles data source selection (including CSV upload), and manages navigation between the different clustering pages. It also contains the `load_synthetic_financial_data` and `preprocess_data` utility functions.
*   **`application_pages/`**: This directory contains separate Python modules, each dedicated to a specific clustering algorithm. This modularity keeps the code organized and easy to maintain.
    *   **`page1.py`**: Implements the K-Means Clustering theory, function, interactive tuning, and visualizations.
    *   **`page2.py`**: Implements the Spectral Clustering theory, function, interactive tuning, and visualizations.
    *   **`page3.py`**: Implements the Agglomerative Hierarchical Clustering theory, function, interactive tuning, visualizations (including dendrogram), and specific parameter validation for 'ward' linkage.

## Technology Stack

*   **Python**: The core programming language.
*   **Streamlit**: For building the interactive web application user interface.
*   **Scikit-learn**: Provides robust implementations of clustering algorithms (KMeans, SpectralClustering, AgglomerativeClustering), data preprocessing (StandardScaler), and evaluation metrics (silhouette_score).
*   **NumPy**: Essential for numerical operations and handling array data.
*   **Pandas**: Used for data manipulation, especially with CSV uploads and structuring data for visualizations.
*   **Plotly Express**: For creating interactive and visually appealing 2D scatter plots of clustering results.
*   **Matplotlib**: Used for generating the static dendrogram visualization in the Hierarchical Clustering section.
*   **SciPy**: Specifically `scipy.cluster.hierarchy` for calculating linkage matrices and plotting dendrograms.

## Contributing

Contributions are welcome! If you have suggestions for improvements, new features, or bug fixes, please follow these steps:

1.  Fork the repository.
2.  Create a new branch (`git checkout -b feature/AmazingFeature`).
3.  Make your changes and ensure they adhere to the existing code style.
4.  Commit your changes (`git commit -m 'Add some AmazingFeature'`).
5.  Push to the branch (`git push origin feature/AmazingFeature`).
6.  Open a Pull Request.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
*(Note: A `LICENSE` file should be created in the root directory if this project is indeed MIT licensed.)*

## Contact

For any questions or inquiries, please refer to:

*   **Organization**: QuantUniversity
*   **Website**: [QuantUniversity](https://www.quantuniversity.com/)

---
*Generated using the provided Streamlit application code.*